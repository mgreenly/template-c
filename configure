#!/bin/bash
set -e

UNITY_VERSION="v2.6.1"  # Specify the version you want

echo "Configuring project..."

# Check if vendor/Unity exists, clone if not
if [ ! -d "vendor/Unity" ]; then
    echo "Setting up Unity test framework (${UNITY_VERSION})..."
    mkdir -p vendor
    cd vendor
    git clone --depth 1 --branch ${UNITY_VERSION} https://github.com/ThrowTheSwitch/Unity.git Unity 2>/dev/null
    cd ..
else
    echo "Unity already exists, updating to ${UNITY_VERSION}..."
    cd vendor/Unity
    git fetch --depth 1 origin tag ${UNITY_VERSION} 2>/dev/null
    git checkout ${UNITY_VERSION} 2>/dev/null
    cd ../..
fi

echo "Configuration complete!"
echo ""
echo "Required system packages:"
echo ""
echo "   $(make -s -f Makefile print-install-cmd 2>/dev/null || echo 'make help # for platform-specific install command')"
echo ""
